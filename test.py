# test_balance_check.py

import pandas as pd
from io import StringIO

data = """
timestamp,symbol,signal,price
2025-05-28 19:00:07,BANUSDT,Open Short,0.06677
2025-05-28 19:00:09,BANUSDT,Open Short,0.06677
2025-05-28 19:00:12,CHESSUSDT,Open Short,0.07792
2025-05-28 19:00:16,CHESSUSDT,Open Short,0.07792
2025-05-28 19:00:18,DOGEPERP,Open Short,0.22017
2025-05-28 19:00:18,DEXEUSDT,Open Long,12.433
2025-05-28 19:00:18,DRIFTUSDT,Open Short,0.6766
2025-05-28 19:00:18,DASHUSDT,Open Short,23.78
2025-05-28 19:00:18,ETHBTCUSDT,Open Long,0.024594
2025-05-28 19:00:21,DASHUSDT,Open Short,23.78
2025-05-28 19:00:21,DRIFTUSDT,Open Short,0.6766
2025-05-28 19:00:21,DOGEPERP,Open Short,0.22017
2025-05-28 19:00:23,GORKUSDT,Open Short,0.01504
2025-05-28 19:00:23,GODSUSDT,Open Short,0.1579
2025-05-28 19:00:23,HNTUSDT,Open Short,3.647
2025-05-28 19:00:23,ICXUSDT,Open Short,0.11729
2025-05-28 19:00:25,GODSUSDT,Open Short,0.1579
2025-05-28 19:00:25,HNTUSDT,Open Short,3.647
2025-05-28 19:00:26,GORKUSDT,Open Short,0.01504
2025-05-28 19:00:26,ICXUSDT,Open Short,0.11729
2025-05-28 19:00:29,KMNOUSDT,Open Short,0.06405
2025-05-28 19:00:29,IPUSDT,Open Short,4.292
2025-05-28 19:00:29,METISUSDT,Open Short,19.57
2025-05-28 19:00:29,NMRUSDT,Open Short,8.627
2025-05-28 19:00:29,OGUSDT,Open Short,5.3962
2025-05-28 19:00:30,OSMOUSDT,Open Short,0.2311
2025-05-28 19:00:30,PUFFERUSDT,Open Short,0.2229
2025-05-28 19:00:30,PUNDIXUSDT,Open Short,0.398
2025-05-28 19:00:30,QTUMUSDT,Open Short,2.169
2025-05-28 19:00:30,SENDUSDT,Open Short,0.8027
2025-05-28 19:00:31,SOLOUSDT,Open Short,0.2628
2025-05-28 19:00:31,SOLPERP,Open Short,170.94
2025-05-28 19:00:31,STEEMUSDT,Open Short,0.1448
2025-05-28 19:00:31,STOUSDT,Open Short,0.11624
2025-05-28 19:00:31,SXPUSDT,Open Short,0.1916
2025-05-28 19:00:31,TRUUSDT,Open Short,0.04126
2025-05-28 19:00:31,TUSDT,Open Short,0.01721
2025-05-28 19:00:32,WAVESUSDT,Open Short,1.2011
2025-05-28 19:00:32,XAUTUSDT,Open Short,3293.68
2025-05-28 19:01:06,1000MUMUUSDT,Open Short,0.004574
2025-05-28 19:01:07,AXLUSDT,Open Short,0.3408
2025-05-28 19:01:07,BLASTUSDT,Open Short,0.003145
2025-05-28 19:01:07,BTCUSDT,Open Short,107398.9
2025-05-28 19:01:07,CHESSUSDT,Open Short,0.0781
2025-05-28 19:01:08,DOGEPERP,Open Short,0.22025
2025-05-28 19:01:08,DRIFTUSDT,Open Short,0.677
2025-05-28 19:01:09,GLMRUSDT,Open Short,0.09049
2025-05-28 19:01:09,HIFIUSDT,Open Short,0.12
2025-05-28 19:01:09,IPUSDT,Open Short,4.294
2025-05-28 19:01:10,NMRUSDT,Open Short,8.638
2025-05-28 19:01:10,OBOLUSDT,Open Short,0.1579
2025-05-28 19:01:11,PAXGUSDT,Open Short,3306.03
2025-05-28 19:01:11,OSMOUSDT,Open Short,0.2311
2025-05-28 19:01:12,SCRTUSDT,Open Short,0.2
2025-05-28 19:01:12,SCAUSDT,Open Short,0.14301
2025-05-28 19:01:12,SOLOUSDT,Open Short,0.2631
2025-05-28 19:01:13,STGUSDT,Open Short,0.1954
2025-05-28 19:01:13,STOUSDT,Open Short,0.11647
2025-05-28 19:01:13,SXPUSDT,Open Short,0.1918
2025-05-28 19:02:05,1000MUMUUSDT,Open Short,0.004569
2025-05-28 19:02:05,1000TOSHIUSDT,Open Short,0.695
2025-05-28 19:02:06,AIXBTUSDT,Open Short,0.23225
2025-05-28 19:02:06,AXLUSDT,Open Short,0.3411
2025-05-28 19:02:07,CARVUSDT,Open Short,0.3723
2025-05-28 19:02:07,BLASTUSDT,Open Short,0.003148
2025-05-28 19:02:07,CVXUSDT,Open Short,3.308
2025-05-28 19:02:07,DOGEPERP,Open Short,0.22046
2025-05-28 19:02:07,DOODUSDT,Open Short,0.003552
2025-05-28 19:02:07,ELXUSDT,Open Short,0.1241
2025-05-28 19:02:08,ETHWUSDT,Open Short,1.687
2025-05-28 19:02:09,IPUSDT,Open Short,4.2979
2025-05-28 19:02:09,INITUSDT,Open Short,0.8723
2025-05-28 19:02:09,LOOKSUSDT,Open Short,0.01638
2025-05-28 19:02:09,OBOLUSDT,Open Short,0.1581
2025-05-28 19:02:09,NMRUSDT,Open Short,8.653
2025-05-28 19:02:10,PENGUUSDT,Open Short,0.012332
2025-05-28 19:02:10,PAXGUSDT,Open Short,3306.42
2025-05-28 19:02:10,PRCLUSDT,Open Short,0.11066
2025-05-28 19:02:10,RUNEUSDT,Open Short,1.927
2025-05-28 19:02:10,SENDUSDT,Open Short,0.8055
2025-05-28 19:02:10,SLERFUSDT,Open Short,0.08458
2025-05-28 19:02:11,STGUSDT,Open Short,0.1956
2025-05-28 19:02:11,SXPUSDT,Open Short,0.1921
2025-05-28 19:02:12,ZEUSUSDT,Open Short,0.2026
2025-05-28 19:03:06,1000CATSUSDT,Open Short,0.009199
2025-05-28 19:03:06,10000QUBICUSDT,Open Short,0.014533
2025-05-28 19:03:06,1000MUMUUSDT,Open Short,0.004584
2025-05-28 19:03:06,10000ELONUSDT,Open Short,0.001428
2025-05-28 19:03:06,AIXBTUSDT,Open Short,0.23242
2025-05-28 19:03:07,AWEUSDT,Open Short,0.06369
2025-05-28 19:03:07,AXLUSDT,Open Short,0.341
2025-05-28 19:03:07,BELUSDT,Open Short,0.3324
2025-05-28 19:03:07,BLASTUSDT,Open Short,0.003147
2025-05-28 19:03:07,BMTUSDT,Open Short,0.09528
2025-05-28 19:03:07,CARVUSDT,Open Short,0.3722
2025-05-28 19:03:08,DOODUSDT,Open Short,0.003556
2025-05-28 19:03:08,DUCKUSDT,Open Short,0.002688
2025-05-28 19:03:08,DOGEUSDT,Open Short,0.22059
2025-05-28 19:03:08,HBARUSDT,Open Short,0.18448
2025-05-28 19:03:08,HFTUSDT,Open Short,0.07142
2025-05-28 19:03:09,HIVEUSDT,Open Short,0.2609
2025-05-28 19:03:09,KASUSDT,Open Short,0.10216
2025-05-28 19:03:09,LOOKSUSDT,Open Short,0.01641
2025-05-28 19:03:09,MASKUSDT,Open Short,2.211
2025-05-28 19:03:10,MORPHOUSDT,Open Short,1.4535
2025-05-28 19:03:10,NILUSDT,Open Short,0.5083
2025-05-28 19:03:10,ORDIUSDT,Open Short,10.837
2025-05-28 19:03:10,PRCLUSDT,Open Short,0.11068
2025-05-28 19:03:11,SENDUSDT,Open Short,0.8067
2025-05-28 19:03:11,SOLAYERUSDT,Open Short,0.9288
2025-05-28 19:03:11,TNSRUSDT,Open Short,0.1564
2025-05-28 19:03:12,WALUSDT,Open Short,0.5426
2025-05-28 19:04:06,10000QUBICUSDT,Open Short,0.014484
2025-05-28 19:04:06,1000CATSUSDT,Open Short,0.009232
2025-05-28 19:04:06,AEROUSDT,Open Short,0.5771
2025-05-28 19:04:07,ANKRUSDT,Open Short,0.01786
2025-05-28 19:04:07,BATUSDT,Open Short,0.1419
2025-05-28 19:04:07,BMTUSDT,Open Short,0.09545
2025-05-28 19:04:07,CROUSDT,Open Short,0.09704
2025-05-28 19:04:08,DRIFTUSDT,Close Short,0.6771
2025-05-28 19:04:08,DENTUSDT,Open Short,0.0008278
2025-05-28 19:04:08,DODOUSDT,Open Short,0.05251
2025-05-28 19:04:08,DOODUSDT,Open Short,0.003552
2025-05-28 19:04:08,DUCKUSDT,Open Short,0.002679
2025-05-28 19:04:08,ELXUSDT,Open Short,0.124
2025-05-28 19:04:08,ETHBTCUSDT,Close Long,0.024679
2025-05-28 19:04:10,FUSDT,Open Short,0.01152
2025-05-28 19:04:10,FORMUSDT,Open Short,2.9688
2025-05-28 19:04:10,GUSDT,Open Short,0.01477
2025-05-28 19:04:10,HEIUSDT,Open Short,0.3538
2025-05-28 19:04:10,HAEDALUSDT,Open Short,0.15201
2025-05-28 19:04:10,HYPEUSDT,Open Short,34.704
2025-05-28 19:04:10,HYPEPERP,Open Short,34.605
2025-05-28 19:04:13,HYPEUSDT,Open Short,34.704
2025-05-28 19:04:13,HYPEPERP,Open Short,34.605
2025-05-28 19:04:13,FORMUSDT,Open Short,2.9688
2025-05-28 19:04:13,GUSDT,Open Short,0.01477
2025-05-28 19:04:13,HAEDALUSDT,Open Short,0.15201
2025-05-28 19:04:13,FUSDT,Open Short,0.01152
2025-05-28 19:04:13,HEIUSDT,Open Short,0.3538
2025-05-28 19:04:16,KMNOUSDT,Open Short,0.06426
2025-05-28 19:04:16,LSKUSDT,Open Short,0.4964
2025-05-28 19:04:16,MAVIAUSDT,Open Short,0.1969
2025-05-28 19:04:17,MTLUSDT,Open Short,0.7974
2025-05-28 19:04:17,MVLUSDT,Open Short,0.003413
2025-05-28 19:04:17,MELANIAUSDT,Open Short,0.3474
2025-05-28 19:04:17,NFPUSDT,Open Short,0.08619
2025-05-28 19:04:17,MDTUSDT,Open Short,0.02896
2025-05-28 19:04:17,NILUSDT,Open Short,0.5091
2025-05-28 19:04:17,NMRUSDT,Open Short,8.67
2025-05-28 19:04:17,NTRNUSDT,Open Short,0.1237
2025-05-28 19:04:17,OGUSDT,Open Short,5.4046
2025-05-28 19:04:18,ORDERUSDT,Open Short,0.098
2025-05-28 19:04:18,OXTUSDT,Open Short,0.06064
2025-05-28 19:04:18,POLYXUSDT,Open Short,0.1587
2025-05-28 19:04:18,QIUSDT,Open Short,0.008354
2025-05-28 19:04:18,PYRUSDT,Open Short,1.152
2025-05-28 19:04:19,REXUSDT,Open Short,0.02065
2025-05-28 19:04:19,RPLUSDT,Open Short,4.885
2025-05-28 19:04:19,SLERFUSDT,Open Short,0.08468
2025-05-28 19:04:19,SOONUSDT,Open Short,0.373
2025-05-28 19:04:19,SPELLUSDT,Open Short,0.0005849
2025-05-28 19:04:19,SPECUSDT,Open Short,1.316
2025-05-28 19:04:19,SUIPERP,Open Short,3.5841
2025-05-28 19:04:19,TRUMPPERP,Open Short,12.447
2025-05-28 19:04:19,TNSRUSDT,Open Short,0.1564
2025-05-28 19:04:20,YGGUSDT,Open Short,0.2154
2025-05-28 19:04:20,YFIUSDT,Open Short,5579.0
2025-05-28 19:04:20,ZBCNUSDT,Open Short,0.0042936
2025-05-28 19:04:20,ZECUSDT,Open Short,52.82
2025-05-28 19:04:20,ZEUSUSDT,Open Short,0.203
2025-05-28 19:05:06,10000WENUSDT,Open Short,0.4911
2025-05-28 19:05:06,1000000MOGUSDT,Open Short,1.1514
2025-05-28 19:05:06,1000BONKUSDT,Open Short,0.019908
2025-05-28 19:05:06,10000ELONUSDT,Open Short,0.001428
2025-05-28 19:05:06,1000PEPEUSDT,Open Short,0.013762
2025-05-28 19:05:06,1000BTTUSDT,Open Short,0.0007195
2025-05-28 19:05:06,1000TURBOUSDT,Open Short,5.1622
2025-05-28 19:05:06,1INCHUSDT,Open Short,0.2315
2025-05-28 19:05:06,1000XUSDT,Open Short,0.08695
2025-05-28 19:05:06,AAVEUSDT,Open Short,266.12
2025-05-28 19:05:06,10000LADYSUSDT,Open Short,0.0004939
2025-05-28 19:05:06,ACTUSDT,Open Short,0.06154
2025-05-28 19:05:06,ADAUSDT,Open Short,0.7477
2025-05-28 19:05:06,AGLDUSDT,Open Short,0.8977
2025-05-28 19:05:06,AEVOUSDT,Open Short,0.1158
2025-05-28 19:05:06,AIXBTUSDT,Open Short,0.23239
2025-05-28 19:05:07,ANKRUSDT,Open Short,0.01786
2025-05-28 19:05:07,ARCUSDT,Open Short,0.0549
2025-05-28 19:05:07,API3USDT,Open Short,0.8045
2025-05-28 19:05:07,ARKMUSDT,Open Short,0.6693
2025-05-28 19:05:07,ARBPERP,Open Short,0.4043
2025-05-28 19:05:07,ARBUSDT,Open Short,0.4043
2025-05-28 19:05:07,ATOMUSDT,Open Short,4.748
2025-05-28 19:05:07,AVAXUSDT,Open Short,23.255
2025-05-28 19:05:07,AVLUSDT,Open Short,0.2369
2025-05-28 19:05:07,BABYUSDT,Open Short,0.07913
2025-05-28 19:05:07,AXSUSDT,Open Short,2.839
2025-05-28 19:05:07,BERAUSDT,Open Short,2.804
2025-05-28 19:05:07,BLASTUSDT,Open Short,0.003147
2025-05-28 19:05:07,BLURUSDT,Open Short,0.1012
2025-05-28 19:05:07,BRETTUSDT,Open Short,0.06618
2025-05-28 19:05:07,BUSDT,Open Short,0.39367
2025-05-28 19:05:07,BTCPERP,Open Short,107691.6
2025-05-28 19:05:07,BTCUSDT,Open Short,107630.0
2025-05-28 19:05:07,CARVUSDT,Open Short,0.3721
2025-05-28 19:05:07,CELRUSDT,Open Short,0.009582
2025-05-28 19:05:07,CHILLGUYUSDT,Open Short,0.080786
2025-05-28 19:05:07,CFXUSDT,Open Short,0.08812
2025-05-28 19:05:07,CKBUSDT,Open Short,0.004997
2025-05-28 19:05:07,COOKUSDT,Open Short,0.009107
2025-05-28 19:05:07,COOKIEUSDT,Open Short,0.2566
2025-05-28 19:05:07,CROUSDT,Open Short,0.09703
2025-05-28 19:05:07,CRVPERP,Open Short,0.7548
2025-05-28 19:05:07,CRVUSDT,Open Short,0.7538
2025-05-28 19:05:07,CTKUSDT,Open Short,0.3547
2025-05-28 19:05:07,CVCUSDT,Open Short,0.13918
2025-05-28 19:05:08,DEXEUSDT,Close Long,12.452
2025-05-28 19:05:08,CVXUSDT,Open Short,3.312
2025-05-28 19:05:08,DEEPUSDT,Open Short,0.17506
2025-05-28 19:05:08,DENTUSDT,Open Short,0.0008281
2025-05-28 19:05:08,DOGEUSDT,Open Short,0.22052
2025-05-28 19:05:08,DOGSUSDT,Open Short,0.000191
2025-05-28 19:05:08,DOTUSDT,Open Short,4.5438
2025-05-28 19:05:08,DUCKUSDT,Open Short,0.002678
2025-05-28 19:05:08,EDUUSDT,Open Short,0.1515
2025-05-28 19:05:08,ENAUSDT,Open Short,0.384
2025-05-28 19:05:08,ENSUSDT,Open Short,23.288
2025-05-28 19:05:08,ETHPERP,Open Short,2654.02
2025-05-28 19:05:08,ETHFIUSDT,Open Short,1.3688
2025-05-28 19:05:08,FILUSDT,Open Short,2.844
2025-05-28 19:05:08,FARTCOINUSDT,Open Short,1.3098
2025-05-28 19:05:08,ETHUSDT,Open Short,2653.23
2025-05-28 19:05:08,FLOCKUSDT,Open Short,0.0862
2025-05-28 19:05:10,GLMUSDT,Open Short,0.26035
2025-05-28 19:05:10,FUSDT,Open Short,0.01152
2025-05-28 19:05:10,FXSUSDT,Open Short,3.2168
2025-05-28 19:05:10,GASUSDT,Open Short,3.241
2025-05-28 19:05:10,GIGAUSDT,Open Short,0.02194
2025-05-28 19:05:10,GODSUSDT,Open Short,0.1587
2025-05-28 19:05:10,GMTUSDT,Open Short,0.05769
2025-05-28 19:05:10,GRASSUSDT,Open Short,2.233
2025-05-28 19:05:10,GRIFFAINUSDT,Open Short,0.08644
2025-05-28 19:05:10,GUNUSDT,Open Short,0.04845
2025-05-28 19:05:10,HEIUSDT,Open Short,0.3537
2025-05-28 19:05:10,GUSDT,Open Short,0.01477
2025-05-28 19:05:10,GORKUSDT,Open Short,0.01531
2025-05-28 19:05:10,HBARUSDT,Open Short,0.18456
2025-05-28 19:05:10,HAEDALUSDT,Open Short,0.15194
2025-05-28 19:05:10,FORMUSDT,Open Short,2.969
2025-05-28 19:05:10,HIPPOUSDT,Open Short,0.002938
2025-05-28 19:05:10,HYPEPERP,Open Short,34.695
2025-05-28 19:05:10,ICXUSDT,Open Short,0.1177
2025-05-28 19:05:10,HYPEUSDT,Open Short,34.683
2025-05-28 19:05:11,INITUSDT,Open Short,0.8709
2025-05-28 19:05:11,IPUSDT,Open Short,4.3
2025-05-28 19:05:11,INJUSDT,Open Short,14.815
2025-05-28 19:05:11,IOUSDT,Open Short,0.9887
2025-05-28 19:05:11,JELLYJELLYUSDT,Open Short,0.031095
2025-05-28 19:05:11,JUPUSDT,Open Short,0.6082
2025-05-28 19:05:11,KASUSDT,Open Short,0.10228
2025-05-28 19:05:11,KOMAUSDT,Open Short,0.02179
2025-05-28 19:05:11,KMNOUSDT,Open Short,0.06424
2025-05-28 19:05:11,KDAUSDT,Open Short,0.5323
2025-05-28 19:05:11,LDOUSDT,Open Short,0.916
2025-05-28 19:05:11,LINKUSDT,Open Short,15.593
2025-05-28 19:05:11,LRCUSDT,Open Short,0.09807
2025-05-28 19:05:11,LUMIAUSDT,Open Short,0.3518
2025-05-28 19:05:11,LSKUSDT,Open Short,0.4967
2025-05-28 19:05:11,MANAUSDT,Open Short,0.3079
2025-05-28 19:05:11,LTCUSDT,Open Short,95.46
2025-05-28 19:05:11,MANTAUSDT,Open Short,0.305
2025-05-28 19:05:11,MAVUSDT,Open Short,0.06411
2025-05-28 19:05:11,MASKUSDT,Open Short,2.222
2025-05-28 19:05:11,MOODENGUSDT,Open Short,0.2478
2025-05-28 19:05:11,MEUSDT,Open Short,0.9514
2025-05-28 19:05:11,MELANIAUSDT,Open Short,0.3471
2025-05-28 19:05:11,MEMEUSDT,Open Short,0.002304
2025-05-28 19:05:11,METISUSDT,Open Short,19.73
2025-05-28 19:05:11,MEWUSDT,Open Short,0.003837
2025-05-28 19:05:11,MOBILEUSDT,Open Short,0.0004475
2025-05-28 19:05:11,MORPHOUSDT,Open Short,1.4552
2025-05-28 19:05:11,MTLUSDT,Open Short,0.7968
2025-05-28 19:05:11,MUBARAKUSDT,Open Short,0.04989
2025-05-28 19:05:11,MVLUSDT,Open Short,0.003413
2025-05-28 19:05:11,NEARUSDT,Open Short,2.818
2025-05-28 19:05:11,NEOUSDT,Open Short,6.559
2025-05-28 19:05:11,NCUSDT,Open Short,0.04092
2025-05-28 19:05:11,NFPUSDT,Open Short,0.08617
2025-05-28 19:05:11,MYROUSDT,Open Short,0.02731
2025-05-28 19:05:11,NILUSDT,Open Short,0.5095
2025-05-28 19:05:11,NXPCUSDT,Open Short,1.8409
2025-05-28 19:05:11,NTRNUSDT,Open Short,0.1239
2025-05-28 19:05:11,ONDOUSDT,Open Short,0.9312
2025-05-28 19:05:12,ORDERUSDT,Open Short,0.098
2025-05-28 19:05:12,ORDIUSDT,Open Short,10.864
2025-05-28 19:05:12,OSMOUSDT,Open Short,0.2324
2025-05-28 19:05:12,OXTUSDT,Open Short,0.06062
2025-05-28 19:05:12,PAXGUSDT,Open Short,3306.03
2025-05-28 19:05:12,PENGUUSDT,Open Short,0.012321
2025-05-28 19:05:12,PIPPINUSDT,Open Short,0.02449
2025-05-28 19:05:12,PNUTUSDT,Open Short,0.3257
2025-05-28 19:05:12,PIXELUSDT,Open Short,0.0558
2025-05-28 19:05:12,PROMPTUSDT,Open Short,0.21246
2025-05-28 19:05:12,PUNDIXUSDT,Open Short,0.3991
2025-05-28 19:05:12,RENDERUSDT,Open Short,4.407
2025-05-28 19:05:12,REZUSDT,Open Short,0.01381
2025-05-28 19:05:12,REXUSDT,Open Short,0.02065
2025-05-28 19:05:12,RPLUSDT,Open Short,4.881
2025-05-28 19:05:12,RSRUSDT,Open Short,0.008352
2025-05-28 19:05:12,SANDUSDT,Open Short,0.3048
2025-05-28 19:05:12,SCRTUSDT,Open Short,0.2009
2025-05-28 19:05:12,SCAUSDT,Open Short,0.14349
2025-05-28 19:05:12,SDUSDT,Open Short,0.5323
2025-05-28 19:05:12,SERAPHUSDT,Open Short,0.16396
2025-05-28 19:05:13,SHIB1000USDT,Open Short,0.014196
2025-05-28 19:05:13,SIGNUSDT,Open Short,0.07997
2025-05-28 19:05:13,SKYAIUSDT,Open Short,0.05588
2025-05-28 19:05:13,SLERFUSDT,Open Short,0.08462
2025-05-28 19:05:13,SOLAYERUSDT,Open Short,0.9285
2025-05-28 19:05:13,SOLUSDT,Open Short,171.56
2025-05-28 19:05:13,SOLPERP,Open Short,171.64
2025-05-28 19:05:13,SONICUSDT,Open Short,0.2865
2025-05-28 19:05:13,SPECUSDT,Open Short,1.315
2025-05-28 19:05:13,STGUSDT,Open Short,0.1958
2025-05-28 19:05:13,STRKUSDT,Open Short,0.1614
2025-05-28 19:05:13,STXUSDT,Open Short,0.863
2025-05-28 19:05:13,SUIPERP,Open Short,3.5841
2025-05-28 19:05:13,SUIUSDT,Open Short,3.5846
2025-05-28 19:05:13,STOUSDT,Open Short,0.11707
2025-05-28 19:05:13,SUNDOGUSDT,Open Short,0.06743
2025-05-28 19:05:13,SWARMSUSDT,Open Short,0.02926
2025-05-28 19:05:13,SWELLUSDT,Open Short,0.01096
2025-05-28 19:05:13,SUPERUSDT,Open Short,0.7791
2025-05-28 19:05:13,SUSDT,Open Short,0.4431
2025-05-28 19:05:13,SYNUSDT,Open Short,0.2028
2025-05-28 19:05:13,SYSUSDT,Open Short,0.04929
2025-05-28 19:05:13,TIAUSDT,Open Short,2.621
2025-05-28 19:05:13,TNSRUSDT,Open Short,0.1562
2025-05-28 19:05:13,TRUMPPERP,Open Short,12.437
2025-05-28 19:05:13,TRUMPUSDT,Open Short,12.444
2025-05-28 19:05:13,TRUUSDT,Open Short,0.04164
2025-05-28 19:05:14,USUALUSDT,Open Short,0.1291
2025-05-28 19:05:14,VIRTUALUSDT,Open Short,2.3136
2025-05-28 19:05:14,WAVESUSDT,Open Short,1.2063
2025-05-28 19:05:14,WALUSDT,Open Short,0.5426
2025-05-28 19:05:14,WAXPUSDT,Open Short,0.02408
2025-05-28 19:05:14,WOOUSDT,Open Short,0.09072
2025-05-28 19:05:14,WUSDT,Open Short,0.10095
2025-05-28 19:05:14,XAIUSDT,Open Short,0.08429
2025-05-28 19:05:14,XCNUSDT,Open Short,0.018299
2025-05-28 19:05:14,XMRUSDT,Open Short,351.2
2025-05-28 19:05:14,ZECUSDT,Open Short,52.84
2025-05-28 19:05:14,ZETAUSDT,Open Short,0.2518
2025-05-28 19:05:14,ZBCNUSDT,Open Short,0.0042699
2025-05-28 19:05:14,ZKUSDT,Open Short,0.06155
2025-05-28 19:05:14,ZEUSUSDT,Open Short,0.2027
2025-05-28 19:05:14,ZROUSDT,Open Short,2.6918

"""

# Read full CSV log (replace data string with your full log)
df = pd.read_csv(StringIO(data), parse_dates=['timestamp'])

# Filter for open signals
open_signals = df[df['signal'].str.startswith('Open')]

# Count unique symbols with open signals
unique_open_symbols = open_signals['symbol'].nunique()

print(f"Unique symbols with open signals: {unique_open_symbols}")

